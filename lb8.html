<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>CBOW –í–µ–∫—Ç–æ—Ä–∏ —Å–ª—ñ–≤</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 40px;
      background: #f5f5f5;
    }
    input, button {
      padding: 8px;
      margin-right: 10px;
      font-size: 16px;
    }
    #results {
      margin-top: 20px;
      background: #fff;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
      max-width: 600px;
    }
  </style>
</head>
<body>

<h2>üîé –ü–æ—à—É–∫ –ø–æ–¥—ñ–±–Ω–∏—Ö —Å–ª—ñ–≤ –∑–∞ CBOW-–º–æ–¥–µ–ª–ª—é</h2>

<input type="text" id="wordInput" placeholder="–í–≤–µ–¥—ñ—Ç—å —Å–ª–æ–≤–æ..." />
<button onclick="findSimilar()">–ó–Ω–∞–π—Ç–∏ –ø–æ–¥—ñ–±–Ω—ñ</button>

<div id="results">‚è≥ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ CBOW...</div>

<script>
  let wordVectors = {};

  // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ –∑ –ø–∞–ø–∫–∏
  fetch("cbow_vectors.json")
    .then(response => response.json())
    .then(data => {
      wordVectors = data;
      document.getElementById('results').innerHTML = "‚úÖ –ú–æ–¥–µ–ª—å —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞. –í–≤–µ–¥—ñ—Ç—å —Å–ª–æ–≤–æ.";
    })
    .catch(error => {
      document.getElementById('results').innerHTML = "‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –º–æ–¥–µ–ª—å.";
      console.error("–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ:", error);
    });

  function cosineSimilarity(vec1, vec2) {
    const dot = vec1.reduce((sum, val, i) => sum + val * vec2[i], 0);
    const norm1 = Math.sqrt(vec1.reduce((sum, val) => sum + val * val, 0));
    const norm2 = Math.sqrt(vec2.reduce((sum, val) => sum + val * val, 0));
    return dot / (norm1 * norm2);
  }

  function findSimilar() {
    const word = document.getElementById('wordInput').value.trim();
    const resultsDiv = document.getElementById('results');
    resultsDiv.innerHTML = '';

    if (!(word in wordVectors)) {
      resultsDiv.innerHTML = `<b>–°–ª–æ–≤–æ "${word}" –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –≤ –º–æ–¥–µ–ª—ñ.</b>`;
      return;
    }

    const inputVec = wordVectors[word];
    const similarities = [];

    for (let [otherWord, vector] of Object.entries(wordVectors)) {
      if (otherWord !== word) {
        const sim = cosineSimilarity(inputVec, vector);
        similarities.push({ word: otherWord, score: sim });
      }
    }

    similarities.sort((a, b) => b.score - a.score);
    const top = similarities.slice(0, 10);

    let html = `<h3>üîó –ù–∞–π–±—ñ–ª—å—à –ø–æ–¥—ñ–±–Ω—ñ –¥–æ "${word}":</h3><ul>`;
    top.forEach(item => {
      html += `<li><b>${item.word}</b>: ${item.score.toFixed(4)}</li>`;
    });
    html += '</ul>';
    resultsDiv.innerHTML = html;
  }
</script>

</body>
</html>
